<!doctype html>
<html>
<head>
<meta charset=utf-8 >
<meta name=viewport content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' >
</head>
<body>
<script src=http://cdnjs.cloudflare.com/ajax/libs/showdown/1.2.3/showdown.min.js ></script>
<script>


	init();

	function init() {

		var css = document.body.appendChild( document.createElement('style') );
		css.innerHTML = 'body { font: 12pt monospace; margin: 0; overflow: auto; }' +
			'h2, a { margin: 0; }' +
			'#i { text-decoration: none; }' +

			'input[type=range] { -webkit-appearance: none; -moz-appearance: none; background-color: silver; height: 20px; width: 180px; } ' +
			'input[type="range"]::-moz-range-thumb { -moz-appearance: none; background-color: #888; width: 10px; } ' +
			'input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; background-color: #888; opacity: 0.5; width: 10px; } ' +

		'';

		hamburger = document.body.appendChild( document.createElement( 'div' ) );
		hamburger.style.cssText = 'position: absolute; left: 340px; transition: left 1s; ';
		hamburger.innerHTML = '<h1><a href=JavaScript:slideMenu(); id=bars >&#9776;</a></h1>';

		menu = hamburger.appendChild( document.createElement( 'div' ) );
		menu.style.cssText = 'background-color: #eee; max-height: ' + ( window.innerHeight - 25 ) + 'px; left: -345px; max-width: 300px; ' +
		'opacity: 0.85; overflow: auto; padding: 0 15px; position: absolute; top: 0;';
		menu.innerHTML = '<div id=header ></div>' +
			'<p><input type=checkbox id=chkRotate onchange=toggleRotate(); checked /> toggle rotation</p>' +
			'<p><input type=checkbox id=chkGradient onchange=toggleGradient(); checked >toggle gradient</p>' +
			'<div id=stats ></div>' +
			'<div id=posts ><h2>NASA 3D Models</h2></div>' +
			'<div id=nasa3DPrinting ><h2>MASA 3D Printing</h2><div>' +


		getBlogPosts();

	}



	function getBlogPosts() {

		var xmlHttp = new XMLHttpRequest();
		xmlHttp.open( 'GET', 'https://api.github.com/jaanga/jaanga.github.io/blogmire/master?recursive=1', true );

		xmlHttp.onreadystatechange = function() {

			if ( xmlHttp.readyState !== 4 ) { return; }

			response =  xmlHttp.responseText;

			var lines = response.split(/\r\n|\n/);
			var textModels = '';
			var textPrinting = '';
			var mods = 0;
			var prints = 0;

			for ( var i = 0; i < lines.length; i++ ) {

				if ( lines[ i ].indexOf( '.stl' ) > -1 ) {

					line = lines[ i ];
					start = line.indexOf( '/' );
					fname =  line.substr( start ).replace( '",','' );

					elements = lines[ i ].split('/' );

					if ( line.indexOf( '3D Models' ) > - 1 ) {

						textModels += '<p><a href="#https://rawgit.com/nasa/NASA-3D-Resources/master/3D Models/' + fname + '" >' +
						fname + '</a></p>';
						mods++

					} else 

						textPrinting += '<p><a href="#https://rawgit.com/nasa/NASA-3D-Resources/master/3D Printing/' + fname + '" >' +
						fname + '</a></p>';
						prints++;
				}

			}

			posts.innerHTML += textModels;
			posts.innerHTML += textPrinting;
//			stats.innerHTML = '3D Model files: ' + mods + '<br>3D Printer files: ' + prints;


		};

		xmlHttp.send( null );

	}

	function requestFile ( obj, fileName ) {

		obj.xmlHttp = new XMLHttpRequest();
		obj.xmlHttp.open( 'GET', fileName, true );
		obj.xmlHttp.onreadystatechange = function() {

			obj.innerHTML = obj.xmlHttp.readyState === 4 ? new showdown.Converter().makeHtml( obj.xmlHttp.responseText ) : '';

		};

		obj.xmlHttp.send( null );

	}

</script>
</body>
</html>